#ifndef FREQUENCY_TABLES_H
#define FREQUENCY_TABLES_H

#include <stdint.h>
#include <avr/pgmspace.h>

// =============================================================================
// YM2612 Frequency Table
// =============================================================================
//
// F-number and block for each MIDI note (0-127)
// Formula: F = (144 * freq * 2^(21-block)) / 7670453
// where 7670453 Hz is the NTSC YM2612 clock
//
// Block acts as octave selector (0-7)
// F-number is 11-bit (0-2047)

struct FMFreq {
    uint16_t fnum;
    uint8_t block;
};

// Pre-calculated table for MIDI notes 0-127
// Based on A4 = 440Hz standard tuning
const FMFreq fmFreqTable[128] PROGMEM = {
    // Octave -1 (MIDI 0-11) - below audible range, use block 0
    {617, 0}, {654, 0}, {693, 0}, {734, 0}, {778, 0}, {824, 0},
    {873, 0}, {925, 0}, {980, 0}, {1038, 0}, {1100, 0}, {1165, 0},
    // Octave 0 (MIDI 12-23)
    {617, 1}, {654, 1}, {693, 1}, {734, 1}, {778, 1}, {824, 1},
    {873, 1}, {925, 1}, {980, 1}, {1038, 1}, {1100, 1}, {1165, 1},
    // Octave 1 (MIDI 24-35)
    {617, 2}, {654, 2}, {693, 2}, {734, 2}, {778, 2}, {824, 2},
    {873, 2}, {925, 2}, {980, 2}, {1038, 2}, {1100, 2}, {1165, 2},
    // Octave 2 (MIDI 36-47)
    {617, 3}, {654, 3}, {693, 3}, {734, 3}, {778, 3}, {824, 3},
    {873, 3}, {925, 3}, {980, 3}, {1038, 3}, {1100, 3}, {1165, 3},
    // Octave 3 (MIDI 48-59)
    {617, 4}, {654, 4}, {693, 4}, {734, 4}, {778, 4}, {824, 4},
    {873, 4}, {925, 4}, {980, 4}, {1038, 4}, {1100, 4}, {1165, 4},
    // Octave 4 (MIDI 60-71) - Middle C at 60
    {617, 5}, {654, 5}, {693, 5}, {734, 5}, {778, 5}, {824, 5},
    {873, 5}, {925, 5}, {980, 5}, {1038, 5}, {1100, 5}, {1165, 5},
    // Octave 5 (MIDI 72-83)
    {617, 6}, {654, 6}, {693, 6}, {734, 6}, {778, 6}, {824, 6},
    {873, 6}, {925, 6}, {980, 6}, {1038, 6}, {1100, 6}, {1165, 6},
    // Octave 6 (MIDI 84-95)
    {617, 7}, {654, 7}, {693, 7}, {734, 7}, {778, 7}, {824, 7},
    {873, 7}, {925, 7}, {980, 7}, {1038, 7}, {1100, 7}, {1165, 7},
    // Octave 7+ (MIDI 96-127) - above normal range, clamp to block 7
    {617, 7}, {654, 7}, {693, 7}, {734, 7}, {778, 7}, {824, 7},
    {873, 7}, {925, 7}, {980, 7}, {1038, 7}, {1100, 7}, {1165, 7},
    {617, 7}, {654, 7}, {693, 7}, {734, 7}, {778, 7}, {824, 7},
    {873, 7}, {925, 7}, {980, 7}, {1038, 7}, {1100, 7}, {1165, 7},
    {617, 7}, {654, 7}, {693, 7}, {734, 7}, {778, 7}, {824, 7},
    {873, 7}, {925, 7},
};

// =============================================================================
// SN76489 Frequency Table
// =============================================================================
//
// 10-bit tone value for each MIDI note
// Formula: N = 3579545 / (32 * freq)
// where 3579545 Hz is the NTSC PSG clock
//
// Values >1023 are clamped (very low notes)
// Values <1 produce no output

const uint16_t psgToneTable[128] PROGMEM = {
    // Octave -1 (MIDI 0-11) - too low, clamp to max
    1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023,
    // Octave 0 (MIDI 12-23)
    1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023,
    // Octave 1 (MIDI 24-35)
    1023, 1023, 1023, 1023, 967, 912, 861, 813, 767, 724, 683, 645,
    // Octave 2 (MIDI 36-47)
    609, 575, 542, 512, 483, 456, 431, 407, 384, 362, 342, 323,
    // Octave 3 (MIDI 48-59)
    305, 287, 271, 256, 242, 228, 215, 203, 192, 181, 171, 161,
    // Octave 4 (MIDI 60-71) - Middle C at 60
    152, 144, 136, 128, 121, 114, 108, 102, 96, 91, 85, 81,
    // Octave 5 (MIDI 72-83)
    76, 72, 68, 64, 60, 57, 54, 51, 48, 45, 43, 40,
    // Octave 6 (MIDI 84-95)
    38, 36, 34, 32, 30, 28, 27, 25, 24, 23, 21, 20,
    // Octave 7 (MIDI 96-107)
    19, 18, 17, 16, 15, 14, 13, 13, 12, 11, 11, 10,
    // Octave 8+ (MIDI 108-127) - very high, values get small
    9, 9, 8, 8, 8, 7, 7, 6, 6, 6, 5, 5,
    5, 5, 4, 4, 4, 4, 3, 3,
};

#endif // FREQUENCY_TABLES_H
